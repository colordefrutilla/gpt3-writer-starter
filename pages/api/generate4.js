import { Configuration, OpenAIApi } from "openai";

const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});

const openai = new OpenAIApi(configuration);
const basePromptPrefix = `
provide me a Sustainable Strategy Template that helps medium size company start filling and identify their sustainability goals (don't mention medium size), assess their current sustainability practices, identify the sustainability goals, analyze Sustainability partnerships or collaborations with key suppliers, and develop a roadmap for achieving their sustainable goals and an implementation of the Roadmap setting kpis to monitor and report. make the template using specific and trigger questions that are tailored for people who are new to sustainability`;
const generateAction = async (req, res) => {
  // Run first prompt
  console.log(`API: ${basePromptPrefix}${req.body.userInput}`);

  const baseCompletion = await openai.createCompletion({
    model: "text-davinci-003",
    prompt: `${basePromptPrefix}${req.body.userInput}\n`,
    temperature: 0.9,
    max_tokens: 2033,
  });

  const basePromptOutput = baseCompletion.data.choices.pop();

  res.status(200).json({ output: basePromptOutput });
};

export default generateAction;
